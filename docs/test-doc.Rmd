---
title: Test shiny
output: 
  html_document:
    runtime: shiny
---
```{r config, include=FALSE}
library(knitr)
library(shiny)
library(tidyverse)

opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE,
               fig.width=4, fig.height=4, dpi=144,
               cache=FALSE)
```
```{r include=FALSE}
d1 <- data_frame(
  x = 1:5,
  xlab = as.character(1:5),
  y = runif(5)
)

d2 <- data_frame(
  x = 1:5,
  xlab = c("a", "b", "c", "d", "e"),
  y = runif(5)
)

d <- bind_rows(d1, d2, .id = "name")
```

```{r}
selectInput(
  inputId = "name",
  label = "Name",
  choices = 1:2,
  selected = 1
)
```

```{r}
renderUI({
  selected <- d %>% filter(name == input$name)
  choices <- unique(selected$xlab)
  checkboxGroupInput(
    inputId = "selected",
    label = "Options",
    choices = choices,
    selected = choices[[1]],
    inline = TRUE)
})
```

```{r}
renderPlot({
  selected <- d %>% filter(name == input$name)
  ggplot(selected) +
    aes(x, y) +
    geom_line(aes(group = 1))
})
```